
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Umgang mit Dateien &#8212; Programmierung und Datenbanken</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://ai4sc-lectures.github.io/Programmierung-und-Datenbanken/Vorlesung/9_Datenhaltung.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Aufgabe 1.1 - Der Print Befehl" href="../Uebung/S1E1-Aufgabe-Print-Funktion/.lesson/instructions.html" />
    <link rel="prev" title="Pakete" href="8_Module.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Programmierung und Datenbanken</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Einführung
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Vorlesungsbeispiele
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="3a_Datentypen.html">
   Datentypen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3b_Operatoren.html">
   Operatoren
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3c_Funktionen.html">
   Funktionen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4a_Verzweigung.html">
   Verzweigungen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4b_Programmablauf.html">
   Programmablauf
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5a_Schleifen.html">
   Schleifen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5b_Rekursion.html">
   Rekursive Funktionen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5c_Such_Algorithmen.html">
   Such- und Sortieralgorithmen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6a_Exceptions.html">
   Exceptions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6b_UnitTest.html">
   Unit-Tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6c_Debugging.html">
   Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7a_Objects.html">
   Objekte
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8_Module.html">
   Pakete
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Umgang mit Dateien
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Übungsaufgaben
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Uebung/S1E1-Aufgabe-Print-Funktion/.lesson/instructions.html">
   Aufgabe 1.1 - Der Print Befehl
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Uebung/S1E2-Aufgabe-Variablen/.lesson/instructions.html">
   Aufgabe 1.2 - Variablendeklarationen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Uebung/S1E3-Aufgabe-Input-Funktion/.lesson/instructions.html">
   Aufgabe 1.3 - Die Input-Funktion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Uebung/S2E1-Aufgabe-Datentypen/.lesson/instructions.html">
   Aufgabe 2.1 - Datentypen &amp; Konvertierungen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Uebung/S2E2-Aufgabe-Funktionen/.lesson/instructions.html">
   Aufgabe 2.2 - Simple Funktionen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Uebung/S3E1-Aufgabe-Flussdiagramm/.lesson/instructions.html">
   Aufgabe 3 - Flussdiagramm
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Uebung/S4E1-Aufgabe-For-Schleife/.lesson/instructions.html">
   Aufgabe 4.1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Uebung/S4E2-Aufgabe-Rekursion/.lesson/instructions.html">
   Aufgabe 4.2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Uebung/S5E1-Aufgabe-Debugging/.lesson/instructions.html">
   Übung 5.1 - Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Uebung/S5E2-Aufgabe-Try-Except/.lesson/instructions.html">
   Übung 5.2 - Try and Except
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Vorlesung/9_Datenhaltung.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dateien-lesen">
   Dateien lesen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dateien-schreiben">
   Dateien schreiben
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datei-existenz-testen">
   Datei existenz testen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dateien-auflisten">
   Dateien auflisten
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dateien-loschen">
   Dateien löschen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#typische-textuelle-dateiformate">
   Typische textuelle Dateiformate
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#txt-dateien">
     TXT-Dateien
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#json-dateien">
     JSON-Dateien
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#geojson-dateien">
   GeoJSON-Dateien
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#xml">
   XML
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#csv-dateien">
     CSV-Dateien
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#typische-binare-dateiformate">
   Typische binäre Dateiformate
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#xls-dateien">
     XLS-Dateien
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zip-dateien">
     ZIP-Dateien
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Umgang mit Dateien</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dateien-lesen">
   Dateien lesen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dateien-schreiben">
   Dateien schreiben
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datei-existenz-testen">
   Datei existenz testen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dateien-auflisten">
   Dateien auflisten
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dateien-loschen">
   Dateien löschen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#typische-textuelle-dateiformate">
   Typische textuelle Dateiformate
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#txt-dateien">
     TXT-Dateien
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#json-dateien">
     JSON-Dateien
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#geojson-dateien">
   GeoJSON-Dateien
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#xml">
   XML
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#csv-dateien">
     CSV-Dateien
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#typische-binare-dateiformate">
   Typische binäre Dateiformate
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#xls-dateien">
     XLS-Dateien
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zip-dateien">
     ZIP-Dateien
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="umgang-mit-dateien">
<h1>Umgang mit Dateien<a class="headerlink" href="#umgang-mit-dateien" title="Permalink to this headline">#</a></h1>
<p>In Programmen müssen regelmäßig Daten geladen und gespeichert werden. Dies geschieht in Computern in Dateien, welche in Verzeichnissen organisiert sind. In der letztem Abschnitt zu Paketen haben wir bereits einige Beispiele gesehen die mit Dateien arbeiten. Diese wollen wir nun detaillierter kennen lernen.</p>
<section id="dateien-lesen">
<h2>Dateien lesen<a class="headerlink" href="#dateien-lesen" title="Permalink to this headline">#</a></h2>
<p>Eine typische Aufgabe ist es Dateien zu laden. Hierfür bietet Python die <code class="docutils literal notranslate"><span class="pre">open()</span></code>-Funktion mit dem Kürzel <code class="docutils literal notranslate"><span class="pre">r</span></code> (read). Hierfür gibt man der <code class="docutils literal notranslate"><span class="pre">open()</span></code>-Funktion den Pfad der zu ladenden Datei an und auch den Datentyp der Datei also ob die Datei eine Textdatei ist <code class="docutils literal notranslate"><span class="pre">t</span></code> oder eine binäre Datei <code class="docutils literal notranslate"><span class="pre">b</span></code> ist.</p>
<p>Die <code class="docutils literal notranslate"><span class="pre">open()</span></code>-Funktion verwendet man meist im <code class="docutils literal notranslate"><span class="pre">with</span></code>-Konstrukt, welcher die Datei einer Variable zuordnet (<code class="docutils literal notranslate"><span class="pre">fi</span></code>) und die Datei nach Beendigung des Blocks auch automatisch schließt. Zum lesen des Inhalts der Datei nutzen wir die <code class="docutils literal notranslate"><span class="pre">read()</span></code> des Dateiobjektes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;geometry/shapes/Line.py&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">dateinhalt</span><span class="o">=</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Datentyp Datei </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">fi</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Datentyp Variable </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">dateinhalt</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dateinhalt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Datentyp Datei &lt;class &#39;_io.TextIOWrapper&#39;&gt;
Datentyp Variable &lt;class &#39;str&#39;&gt;
from geometry.points.ImmutablePoint import ImmutablePoint

class Line:
    def __init__(self, start: ImmutablePoint, end: ImmutablePoint):
        if not isinstance(start, ImmutablePoint):
            raise TypeError(&quot;start not of type ImmutablePoint&quot;)
        if not isinstance(end, ImmutablePoint):
            raise TypeError(&quot;end not of type ImmutablePoint&quot;)
        self.start = start
        self.end = end

    def length(self):
        return self.start.distance(self.end)
</pre></div>
</div>
</div>
</div>
<p>In gleicher Form kann man auch binäre Dateien einlesen. Dafür tauschen wir den Dateityp <code class="docutils literal notranslate"><span class="pre">t</span></code> mit binär aus <code class="docutils literal notranslate"><span class="pre">b</span></code> und laden die Datei. Wir sehen, dass jetzt der Datentyp der geladenen Dateinhalts zu <code class="docutils literal notranslate"><span class="pre">byte</span></code> wechselt. Printen wir den Dateinhalt sehen wir auch direkt die Sonderzeichen in der Datei wie <code class="docutils literal notranslate"><span class="pre">\r</span></code> und <code class="docutils literal notranslate"><span class="pre">\n</span></code> welche für den Zeilenumbruch stehen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;geometry/shapes/Line.py&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">dateinhalt</span><span class="o">=</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Datentyp Datei </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">fi</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Datentyp Variable </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">dateinhalt</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dateinhalt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Datentyp Datei &lt;class &#39;_io.BufferedReader&#39;&gt;
Datentyp Variable &lt;class &#39;bytes&#39;&gt;
b&#39;from geometry.points.ImmutablePoint import ImmutablePoint\n\nclass Line:\n    def __init__(self, start: ImmutablePoint, end: ImmutablePoint):\n        if not isinstance(start, ImmutablePoint):\n            raise TypeError(&quot;start not of type ImmutablePoint&quot;)\n        if not isinstance(end, ImmutablePoint):\n            raise TypeError(&quot;end not of type ImmutablePoint&quot;)\n        self.start = start\n        self.end = end\n\n    def length(self):\n        return self.start.distance(self.end)&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="dateien-schreiben">
<h2>Dateien schreiben<a class="headerlink" href="#dateien-schreiben" title="Permalink to this headline">#</a></h2>
<p>In gleicher Weise können wir mit der <code class="docutils literal notranslate"><span class="pre">open()</span></code>-Funktion auch neue Dateien erzeugen. Hierfür nutzen wir das Kürzel <code class="docutils literal notranslate"><span class="pre">w</span></code> (write). Auch hier werden Textdateien mit <code class="docutils literal notranslate"><span class="pre">t</span></code> und binäre Dateien mit <code class="docutils literal notranslate"><span class="pre">b</span></code> unterschieden. Zum Schreiben der Datei nutzen wir die <code class="docutils literal notranslate"><span class="pre">write()</span></code>-Methode des Dateiobjektes <code class="docutils literal notranslate"><span class="pre">fo</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;meineDatei.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;tw&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fo</span><span class="p">:</span>
    <span class="n">dateinhalt</span><span class="o">=</span><span class="s2">&quot;Meine eigener Inhalt&quot;</span>
    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dateinhalt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Zum überprüfen lesen wir die Datei wieder.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;meineDatei.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Meine eigener Inhalt
</pre></div>
</div>
</div>
</div>
<p>Wichtig zu wissen ist, dass die Datei vollständig überschrieben wird.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;meineDatei.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;tw&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fo</span><span class="p">:</span>
    <span class="n">dateinhalt</span><span class="o">=</span><span class="s2">&quot;Neuer Inhalt&quot;</span>
    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dateinhalt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;meineDatei.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Neuer Inhalt
</pre></div>
</div>
</div>
</div>
</section>
<section id="datei-existenz-testen">
<h2>Datei existenz testen<a class="headerlink" href="#datei-existenz-testen" title="Permalink to this headline">#</a></h2>
<p>Häufig will man testen ob eine Datei bereits existiert und dementsprechend diese laden oder z.B. neu erzeugen. Solche und andere Funktionen bietet die Standardbibliothek <code class="docutils literal notranslate"><span class="pre">os</span></code> die wir bereits kennen gelernt haben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;meineDatei.txt&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Datei existiert&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Datei existiert noch nicht&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Datei existiert
</pre></div>
</div>
</div>
</div>
</section>
<section id="dateien-auflisten">
<h2>Dateien auflisten<a class="headerlink" href="#dateien-auflisten" title="Permalink to this headline">#</a></h2>
<p>Zum Auflisten aller Dateien in einem Verzeichnis <code class="docutils literal notranslate"><span class="pre">folder</span></code> können wir die Funktion <code class="docutils literal notranslate"><span class="pre">os.listdir()</span></code> benutzen. Mit der Funktion <code class="docutils literal notranslate"><span class="pre">os.path.isfile()</span></code> können wir prüfen ob der Name auf eine Datei oder ein Verzeichnis ist. Ist es eine Datei, so können wir diese mit der <code class="docutils literal notranslate"><span class="pre">open</span></code>-Funktion öffnen, um z.B. alle Dateien zu laden und die Anzahl der Code-Zeilen zu berechnen. Dafür nutzen wir anstatt der <code class="docutils literal notranslate"><span class="pre">read</span></code>-Funktion die <code class="docutils literal notranslate"><span class="pre">readlines</span></code>-Funktion um alle Zeilen einzeln in einer Liste zu erhalten.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">folder</span> <span class="o">=</span> <span class="s2">&quot;geometry/shapes/&quot;</span>
<span class="n">files</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">codelines</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder</span><span class="p">)):</span>
	<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">name</span><span class="p">)):</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="s2">&quot;tr&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
			<span class="n">codelines</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>
			<span class="n">files</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">codelines</span><span class="si">}</span><span class="s2"> Codezeilen in </span><span class="si">{</span><span class="n">files</span><span class="si">}</span><span class="s2"> Dateien&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>64 Codezeilen in 5 Dateien
</pre></div>
</div>
</div>
</div>
</section>
<section id="dateien-loschen">
<h2>Dateien löschen<a class="headerlink" href="#dateien-loschen" title="Permalink to this headline">#</a></h2>
<p>Die <code class="docutils literal notranslate"><span class="pre">os</span></code>-Paket bietet auch Funktionen, um Dateien zu löschen. Selbstverständlich sollte die mit Vorsicht verwendet werdet werden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;meineDatei.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="typische-textuelle-dateiformate">
<h2>Typische textuelle Dateiformate<a class="headerlink" href="#typische-textuelle-dateiformate" title="Permalink to this headline">#</a></h2>
<section id="txt-dateien">
<h3>TXT-Dateien<a class="headerlink" href="#txt-dateien" title="Permalink to this headline">#</a></h3>
<p>Eine der einfachsten Formate um Texte auf dem Computer zu Speichern sind Text-Dateien. Sie haben meist die Dateiendung <code class="docutils literal notranslate"><span class="pre">.txt</span></code>. Diese Dateiänderung haben wir bereits oben genutzt.</p>
</section>
<section id="json-dateien">
<h3>JSON-Dateien<a class="headerlink" href="#json-dateien" title="Permalink to this headline">#</a></h3>
<p>Heutzutage werden strukturierte Informationen oft im <code class="docutils literal notranslate"><span class="pre">JSON</span></code>-Format ausgetauscht. Insbesondere viele APIs von Webserver im Internet nutzen diesen Standard. Er hat den Vorteil, dass die Daten durch den Menschen lesbar bleiben und somit auch vom Webdeveloper interpretiert werden können. Im Kern ähnelt der Standard der Darstellung von <code class="docutils literal notranslate"><span class="pre">dict</span></code> in Python.</p>
<p>Wir können zum Beispiel den Datensatz zu einer Person in dem folgendem <code class="docutils literal notranslate"><span class="pre">dict</span></code> speichern.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">person</span><span class="o">=</span><span class="p">{</span>
	<span class="s2">&quot;firstName&quot;</span><span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
	<span class="s2">&quot;lastName&quot;</span><span class="p">:</span> <span class="s2">&quot;Smith&quot;</span><span class="p">,</span>
	<span class="s2">&quot;isAlive&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
	<span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
	<span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="p">{</span>
		<span class="s2">&quot;streetAddress&quot;</span><span class="p">:</span> <span class="s2">&quot;21 2nd Street&quot;</span><span class="p">,</span>
		<span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="s2">&quot;New York&quot;</span><span class="p">,</span>
		<span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;NY&quot;</span><span class="p">,</span>
		<span class="s2">&quot;postalCode&quot;</span><span class="p">:</span> <span class="s2">&quot;10021-3100&quot;</span> 
	<span class="p">},</span>
 	<span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[],</span>
	<span class="s2">&quot;spouse&quot;</span><span class="p">:</span> <span class="kc">None</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Mit Hilfe des <code class="docutils literal notranslate"><span class="pre">json</span></code>-Pakets lässt sich dieser Datensatz jetzt einfach in ein <code class="docutils literal notranslate"><span class="pre">JSON</span></code> String umwandeln und in eine Datei schreiben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;person.json&quot;</span><span class="p">,</span> <span class="s2">&quot;tw&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fo</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">person</span><span class="p">,</span> <span class="n">fo</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Schauen wir uns einmal die Datei an. Da es eine textuelle Datei ist, können wir sie mit <code class="docutils literal notranslate"><span class="pre">open(name,</span> <span class="pre">&quot;tr&quot;)</span></code> laden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;person.json&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">dateinhalt</span><span class="o">=</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dateinhalt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
  &quot;firstName&quot;: &quot;John&quot;,
  &quot;lastName&quot;: &quot;Smith&quot;,
  &quot;isAlive&quot;: true,
  &quot;age&quot;: 25,
  &quot;address&quot;: {
    &quot;streetAddress&quot;: &quot;21 2nd Street&quot;,
    &quot;city&quot;: &quot;New York&quot;,
    &quot;state&quot;: &quot;NY&quot;,
    &quot;postalCode&quot;: &quot;10021-3100&quot;
  },
  &quot;children&quot;: [],
  &quot;spouse&quot;: null
}
</pre></div>
</div>
</div>
</div>
<p>Wir sehen, dass die JSON-Representation dem oben definiertem Dictionary <code class="docutils literal notranslate"><span class="pre">person</span></code> sehr ähnlich ist. Die einzigen unterschiede sind, dass das in Pyton Großgeschriebene <code class="docutils literal notranslate"><span class="pre">True</span></code> hier klein geschrieben wird und das <code class="docutils literal notranslate"><span class="pre">none</span></code> aus Python mit <code class="docutils literal notranslate"><span class="pre">null</span></code> ersetzt wurde. Die Struktur beider Repräsentationen ist jedoch identisch.</p>
<p>Aus dieser Textdatei können wir jetzt unseren Datensatz direkt als <code class="docutils literal notranslate"><span class="pre">dict</span></code> wieder laden. Zur Darstellung nutzen wir diesmal pretty Print, weil es besser zu lesen ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;person.json&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">person_geladen</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fi</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Datentyp </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">person_geladen</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">person_geladen</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Datentyp &lt;class &#39;dict&#39;&gt;
{&#39;address&#39;: {&#39;city&#39;: &#39;New York&#39;,
             &#39;postalCode&#39;: &#39;10021-3100&#39;,
             &#39;state&#39;: &#39;NY&#39;,
             &#39;streetAddress&#39;: &#39;21 2nd Street&#39;},
 &#39;age&#39;: 25,
 &#39;children&#39;: [],
 &#39;firstName&#39;: &#39;John&#39;,
 &#39;isAlive&#39;: True,
 &#39;lastName&#39;: &#39;Smith&#39;,
 &#39;spouse&#39;: None}
</pre></div>
</div>
</div>
</div>
<p>Das geladene <code class="docutils literal notranslate"><span class="pre">dict</span></code> entspricht unserem ursprünglichem Dictionary <code class="docutils literal notranslate"><span class="pre">person</span></code>. Es hat sich zwar die Reihenfolge der Einträge geändert, aber dies ist nicht garantiert in J</p>
</section>
</section>
<section id="geojson-dateien">
<h2>GeoJSON-Dateien<a class="headerlink" href="#geojson-dateien" title="Permalink to this headline">#</a></h2>
<p>Eine besondere Variante des JSON-Formates das insbesondere für die Umweltinformatik relevant ist, ist das standartisierte <a class="reference external" href="https://geojson.org/">GeoJSON-Format</a>. Dieses auf JSON-basierende Format definiert wie bestimmte Geometrische Objekte wie Punkt, Linien und Polygone in JSON dargestellt werden sollen. Jedes Element wird dabei als JSON-Objekt (<code class="docutils literal notranslate"><span class="pre">dict</span></code> in Python) beschrieben und definiert die Attribute <code class="docutils literal notranslate"><span class="pre">type</span></code> und <code class="docutils literal notranslate"><span class="pre">coordinates</span></code>.</p>
<p>Ein Punkt ist dabei definiert als Element mit dem Typen <code class="docutils literal notranslate"><span class="pre">Point</span></code> und zwei Koordinaten.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">punkt</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span>
    <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">12.095843457646907</span><span class="p">,</span> <span class="mf">54.075229197333016</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Eine Linie ist gegeben als <code class="docutils literal notranslate"><span class="pre">LineString</span></code> mit einer Liste an Punkt-Koordinaten, welche meist die Anfangs- und End-Koordinaten sind. Werden im <code class="docutils literal notranslate"><span class="pre">LineString</span></code> mehr als zwei Koordinaten angegeben haben wir eine Linienkette.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">linie_oki_auf</span> <span class="o">=</span> <span class="p">{</span> 
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;LineString&quot;</span><span class="p">,</span>
    <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span> <span class="mf">12.095844241344963</span><span class="p">,</span> <span class="mf">54.075206445655795</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">12.09606074723871</span><span class="p">,</span> <span class="mf">54.075028604743636</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">12.09593084370266</span><span class="p">,</span> <span class="mf">54.074930156768204</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">12.096282665780166</span><span class="p">,</span> <span class="mf">54.07495873846247</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">12.096558710795335</span><span class="p">,</span> <span class="mf">54.07507941651065</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">12.096840168457192</span><span class="p">,</span> <span class="mf">54.074863466071434</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">12.098052601464076</span><span class="p">,</span> <span class="mf">54.07534617726671</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">12.098187917647891</span><span class="p">,</span> <span class="mf">54.07534617726671</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">12.098317821183883</span><span class="p">,</span> <span class="mf">54.07541286718799</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">12.098377360305278</span><span class="p">,</span> <span class="mf">54.075339825840246</span> <span class="p">],</span>
        <span class="p">[</span> <span class="mf">12.098501851194726</span><span class="p">,</span> <span class="mf">54.0753779343855</span> <span class="p">]</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Ein Polygon ist definiert mit dem Typ <code class="docutils literal notranslate"><span class="pre">Polygon</span></code> wessen Koordinaten geben ist als Liste einer oder meherer Linienketten, welche geschlossen sind, so dass der Endpunkt mit dem Startpunkt übereinstimmt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">campus</span> <span class="o">=</span> <span class="p">{</span> 
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
    <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span> <span class="mf">12.093402064538196</span><span class="p">,</span> <span class="mf">54.07479416035679</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.094194380118807</span><span class="p">,</span> <span class="mf">54.074246433609375</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.094578770845374</span><span class="p">,</span> <span class="mf">54.074103747303894</span> <span class="p">]</span> <span class="p">,</span>
            <span class="p">[</span> <span class="mf">12.095018074534778</span><span class="p">,</span> <span class="mf">54.074191200259065</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.095661340649713</span><span class="p">,</span> <span class="mf">54.074435147002276</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.096328140890677</span><span class="p">,</span> <span class="mf">54.073947252082434</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.098359920447564</span><span class="p">,</span> <span class="mf">54.075010487417984</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.098822758261605</span><span class="p">,</span> <span class="mf">54.07471591412107</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.099866104521425</span><span class="p">,</span> <span class="mf">54.07523141601854</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.09959938442529</span><span class="p">,</span> <span class="mf">54.075383303749476</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.100462302384159</span><span class="p">,</span> <span class="mf">54.075700885391115</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.098869826513692</span><span class="p">,</span> <span class="mf">54.0770356222489</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.09752838132394</span><span class="p">,</span> <span class="mf">54.076602988106</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.095394620552042</span><span class="p">,</span> <span class="mf">54.076082900668524</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.09422575895411</span><span class="p">,</span> <span class="mf">54.07581595060367</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.094743509729398</span><span class="p">,</span> <span class="mf">54.07538790639916</span> <span class="p">],</span>
            <span class="p">[</span> <span class="mf">12.093402064538196</span><span class="p">,</span> <span class="mf">54.07479416035679</span> <span class="p">]</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Da viele Objekte ja nicht neben der Geometrie auch noch weitere Attribute haben, gibt es das Hilfsobjekt <code class="docutils literal notranslate"><span class="pre">Feature</span></code> indem es das Attribute <code class="docutils literal notranslate"><span class="pre">properties</span></code> gibt in dem man eigenen Meta-Daten definieren kann. So können wir uns ein GeoJSON-Objekt definieren, um die Position des OKI zu speichern.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oki</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
  <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span>
    <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">12.095843457646907</span><span class="p">,</span> <span class="mf">54.075229197333016</span><span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;OKI&quot;</span><span class="p">,</span>
    <span class="s2">&quot;addresse&quot;</span><span class="p">:</span> <span class="s2">&quot;Justus-von-Liebig-Weg 2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;stadt&quot;</span><span class="p">:</span> <span class="s2">&quot;Rostock&quot;</span><span class="p">,</span>
    <span class="s2">&quot;postleitzahl&quot;</span><span class="p">:</span><span class="s2">&quot;18059&quot;</span><span class="p">,</span>
    <span class="s2">&quot;land&quot;</span><span class="p">:</span> <span class="s2">&quot;Deutschland&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">auf</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
  <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span>
    <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">12.098494794410726</span><span class="p">,</span> <span class="mf">54.075390284810425</span><span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;AUF&quot;</span><span class="p">,</span>
    <span class="s2">&quot;addresse&quot;</span><span class="p">:</span> <span class="s2">&quot;Justus-von-Liebig-Weg 6&quot;</span><span class="p">,</span>
    <span class="s2">&quot;stadt&quot;</span><span class="p">:</span> <span class="s2">&quot;Rostock&quot;</span><span class="p">,</span>
    <span class="s2">&quot;postleitzahl&quot;</span><span class="p">:</span><span class="s2">&quot;18059&quot;</span><span class="p">,</span>
    <span class="s2">&quot;land&quot;</span><span class="p">:</span> <span class="s2">&quot;Deutschland&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">weg_oki_auf</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
  <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">linie_oki_auf</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Weg OKI zu AUF&quot;</span><span class="p">,</span>
    <span class="s2">&quot;stadt&quot;</span><span class="p">:</span> <span class="s2">&quot;Rostock&quot;</span><span class="p">,</span>
    <span class="s2">&quot;postleitzahl&quot;</span><span class="p">:</span><span class="s2">&quot;18059&quot;</span><span class="p">,</span>
    <span class="s2">&quot;land&quot;</span><span class="p">:</span> <span class="s2">&quot;Deutschland&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
    
<span class="n">campus_auf</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
  <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">campus</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Campus&quot;</span><span class="p">,</span>
    <span class="s2">&quot;stadt&quot;</span><span class="p">:</span> <span class="s2">&quot;Rostock&quot;</span><span class="p">,</span>
    <span class="s2">&quot;postleitzahl&quot;</span><span class="p">:</span><span class="s2">&quot;18059&quot;</span><span class="p">,</span>
    <span class="s2">&quot;land&quot;</span><span class="p">:</span> <span class="s2">&quot;Deutschland&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Eine Sammlung an <code class="docutils literal notranslate"><span class="pre">Features</span></code> wird in einer <code class="docutils literal notranslate"><span class="pre">FeatureCollection</span></code> abgelegt. Sie besitzt neben dem <code class="docutils literal notranslate"><span class="pre">type</span></code> die Liste <code class="docutils literal notranslate"><span class="pre">features</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
  <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="n">oki</span><span class="p">,</span>
    <span class="n">auf</span><span class="p">,</span>
    <span class="n">weg_oki_auf</span><span class="p">,</span>
    <span class="n">campus_auf</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Zur Verarbeitung dieser GeoJSON-Objekte in Python können wir das Paket <code class="docutils literal notranslate"><span class="pre">geojson</span></code> nutzen. Wir installieren diese wieder mit <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">geojson</span>  <span class="o">--</span><span class="n">quiet</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip available: <span class=" -Color -Color-Red">22.3</span> -&gt; <span class=" -Color -Color-Green">22.3.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<p>Das Paket <code class="docutils literal notranslate"><span class="pre">geojson</span></code> bietet uns auch Standardklassen für Punkte, Linien und Polygone an, die wir uns zuvor selbst als <span class="xref myst">Klassen</span> definiert hatten. Aufgrund des umfangreichen Angebots and Paketen für Python lassen sich häufig auch Pakete finden, die entsprechende Klassen für die eigenen Problemstellungen bieten, so dass sich immer eine Suche lohnt. Ein Punkt in GeoJSON erzeugen wir mit dem Paket durch</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geojson</span> <span class="kn">import</span> <span class="n">Point</span>

<span class="n">geojson_punkt</span><span class="o">=</span><span class="n">Point</span><span class="p">((</span><span class="mf">12.095843457646907</span><span class="p">,</span> <span class="mf">54.075229197333016</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">geojson_punkt</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">geojson_punkt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;geojson.geometry.Point&#39;&gt;
{&quot;coordinates&quot;: [12.095843, 54.075229], &quot;type&quot;: &quot;Point&quot;}
</pre></div>
</div>
</div>
</div>
<p>Neue Instanzen lassen sich auch direkt aus dem JSON erzeugen. Hierfür benutzen wir die <code class="docutils literal notranslate"><span class="pre">loads</span></code>-Funktion des Pakets. Sie wandelt einen JSON-String in ein Objekt um. Um den JSON-String zu erzeugen, wandeln wir das Dictionary <code class="docutils literal notranslate"><span class="pre">punkt</span></code> in ein String um mit der Funktion <code class="docutils literal notranslate"><span class="pre">json.dumps()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geojson</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">json_str</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">punkt</span><span class="p">)</span>
<span class="n">gson_punkt</span><span class="o">=</span><span class="n">geojson</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">gson_punkt</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gson_punkt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;geojson.geometry.Point&#39;&gt;
{&quot;coordinates&quot;: [12.095843, 54.075229], &quot;type&quot;: &quot;Point&quot;}
</pre></div>
</div>
</div>
</div>
<p>So lässt sich auch unser ganze Feature Collection laden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geojson</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">json_str</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<span class="n">gson_features</span><span class="o">=</span><span class="n">geojson</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">gson_features</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gson_features</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;geojson.feature.FeatureCollection&#39;&gt;
{&quot;features&quot;: [{&quot;geometry&quot;: {&quot;coordinates&quot;: [12.095843, 54.075229], &quot;type&quot;: &quot;Point&quot;}, &quot;properties&quot;: {&quot;addresse&quot;: &quot;Justus-von-Liebig-Weg 2&quot;, &quot;land&quot;: &quot;Deutschland&quot;, &quot;name&quot;: &quot;OKI&quot;, &quot;postleitzahl&quot;: &quot;18059&quot;, &quot;stadt&quot;: &quot;Rostock&quot;}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;geometry&quot;: {&quot;coordinates&quot;: [12.098495, 54.07539], &quot;type&quot;: &quot;Point&quot;}, &quot;properties&quot;: {&quot;addresse&quot;: &quot;Justus-von-Liebig-Weg 6&quot;, &quot;land&quot;: &quot;Deutschland&quot;, &quot;name&quot;: &quot;AUF&quot;, &quot;postleitzahl&quot;: &quot;18059&quot;, &quot;stadt&quot;: &quot;Rostock&quot;}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;geometry&quot;: {&quot;coordinates&quot;: [[12.095844, 54.075206], [12.096061, 54.075029], [12.095931, 54.07493], [12.096283, 54.074959], [12.096559, 54.075079], [12.09684, 54.074863], [12.098053, 54.075346], [12.098188, 54.075346], [12.098318, 54.075413], [12.098377, 54.07534], [12.098502, 54.075378]], &quot;type&quot;: &quot;LineString&quot;}, &quot;properties&quot;: {&quot;land&quot;: &quot;Deutschland&quot;, &quot;name&quot;: &quot;Weg OKI zu AUF&quot;, &quot;postleitzahl&quot;: &quot;18059&quot;, &quot;stadt&quot;: &quot;Rostock&quot;}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;geometry&quot;: {&quot;coordinates&quot;: [[[12.093402, 54.074794], [12.094194, 54.074246], [12.094579, 54.074104], [12.095018, 54.074191], [12.095661, 54.074435], [12.096328, 54.073947], [12.09836, 54.07501], [12.098823, 54.074716], [12.099866, 54.075231], [12.099599, 54.075383], [12.100462, 54.075701], [12.09887, 54.077036], [12.097528, 54.076603], [12.095395, 54.076083], [12.094226, 54.075816], [12.094744, 54.075388], [12.093402, 54.074794]]], &quot;type&quot;: &quot;Polygon&quot;}, &quot;properties&quot;: {&quot;land&quot;: &quot;Deutschland&quot;, &quot;name&quot;: &quot;Campus&quot;, &quot;postleitzahl&quot;: &quot;18059&quot;, &quot;stadt&quot;: &quot;Rostock&quot;}, &quot;type&quot;: &quot;Feature&quot;}], &quot;type&quot;: &quot;FeatureCollection&quot;}
</pre></div>
</div>
</div>
</div>
<p>Der Vorteil von GeoJSON-Objekten ist, dass wiederum viele weitere Pakete existieren, um dieses Format zu analysieren. Wollen wir zum Beispile unsere Feature Collection auf einer Karte visualisieren, können wir das Paket <code class="docutils literal notranslate"><span class="pre">geojsonio</span></code> nutzen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">geojsonio</span>  <span class="o">--</span><span class="n">quiet</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip available: <span class=" -Color -Color-Red">22.3</span> -&gt; <span class=" -Color -Color-Green">22.3.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geojsonio</span>

<span class="n">geojsonio</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;http://geojson.io/#data=data:application/json,%7B%22type%22%3A%20%22FeatureCollection%22%2C%20%22features%22%3A%20%5B%7B%22type%22%3A%20%22Feature%22%2C%20%22geometry%22%3A%20%7B%22type%22%3A%20%22Point%22%2C%20%22coordinates%22%3A%20%5B12.095843457646907%2C%2054.075229197333016%5D%7D%2C%20%22properties%22%3A%20%7B%22name%22%3A%20%22OKI%22%2C%20%22addresse%22%3A%20%22Justus-von-Liebig-Weg%202%22%2C%20%22stadt%22%3A%20%22Rostock%22%2C%20%22postleitzahl%22%3A%20%2218059%22%2C%20%22land%22%3A%20%22Deutschland%22%7D%7D%2C%20%7B%22type%22%3A%20%22Feature%22%2C%20%22geometry%22%3A%20%7B%22type%22%3A%20%22Point%22%2C%20%22coordinates%22%3A%20%5B12.098494794410726%2C%2054.075390284810425%5D%7D%2C%20%22properties%22%3A%20%7B%22name%22%3A%20%22AUF%22%2C%20%22addresse%22%3A%20%22Justus-von-Liebig-Weg%206%22%2C%20%22stadt%22%3A%20%22Rostock%22%2C%20%22postleitzahl%22%3A%20%2218059%22%2C%20%22land%22%3A%20%22Deutschland%22%7D%7D%2C%20%7B%22type%22%3A%20%22Feature%22%2C%20%22geometry%22%3A%20%7B%22type%22%3A%20%22LineString%22%2C%20%22coordinates%22%3A%20%5B%5B12.095844241344963%2C%2054.075206445655795%5D%2C%20%5B12.09606074723871%2C%2054.075028604743636%5D%2C%20%5B12.09593084370266%2C%2054.074930156768204%5D%2C%20%5B12.096282665780166%2C%2054.07495873846247%5D%2C%20%5B12.096558710795335%2C%2054.07507941651065%5D%2C%20%5B12.096840168457192%2C%2054.074863466071434%5D%2C%20%5B12.098052601464076%2C%2054.07534617726671%5D%2C%20%5B12.098187917647891%2C%2054.07534617726671%5D%2C%20%5B12.098317821183883%2C%2054.07541286718799%5D%2C%20%5B12.098377360305278%2C%2054.075339825840246%5D%2C%20%5B12.098501851194726%2C%2054.0753779343855%5D%5D%7D%2C%20%22properties%22%3A%20%7B%22name%22%3A%20%22Weg%20OKI%20zu%20AUF%22%2C%20%22stadt%22%3A%20%22Rostock%22%2C%20%22postleitzahl%22%3A%20%2218059%22%2C%20%22land%22%3A%20%22Deutschland%22%7D%7D%2C%20%7B%22type%22%3A%20%22Feature%22%2C%20%22geometry%22%3A%20%7B%22type%22%3A%20%22Polygon%22%2C%20%22coordinates%22%3A%20%5B%5B%5B12.093402064538196%2C%2054.07479416035679%5D%2C%20%5B12.094194380118807%2C%2054.074246433609375%5D%2C%20%5B12.094578770845374%2C%2054.074103747303894%5D%2C%20%5B12.095018074534778%2C%2054.074191200259065%5D%2C%20%5B12.095661340649713%2C%2054.074435147002276%5D%2C%20%5B12.096328140890677%2C%2054.073947252082434%5D%2C%20%5B12.098359920447564%2C%2054.075010487417984%5D%2C%20%5B12.098822758261605%2C%2054.07471591412107%5D%2C%20%5B12.099866104521425%2C%2054.07523141601854%5D%2C%20%5B12.09959938442529%2C%2054.075383303749476%5D%2C%20%5B12.100462302384159%2C%2054.075700885391115%5D%2C%20%5B12.098869826513692%2C%2054.0770356222489%5D%2C%20%5B12.09752838132394%2C%2054.076602988106%5D%2C%20%5B12.095394620552042%2C%2054.076082900668524%5D%2C%20%5B12.09422575895411%2C%2054.07581595060367%5D%2C%20%5B12.094743509729398%2C%2054.07538790639916%5D%2C%20%5B12.093402064538196%2C%2054.07479416035679%5D%5D%5D%7D%2C%20%22properties%22%3A%20%7B%22name%22%3A%20%22Campus%22%2C%20%22stadt%22%3A%20%22Rostock%22%2C%20%22postleitzahl%22%3A%20%2218059%22%2C%20%22land%22%3A%20%22Deutschland%22%7D%7D%5D%7D&#39;
</pre></div>
</div>
</div>
</div>
<p>Wenn wir dem Link folgen kommen wir zu einer Webseite die uns die Polygone, Linie und Punkte anzeigt.</p>
<p><img alt="Campus" src="../_images/campus.png" /></p>
<p>Weitere Anwendungen von GeoJSON werden wir in der Übung kennen lernen.</p>
</section>
<section id="xml">
<h2>XML<a class="headerlink" href="#xml" title="Permalink to this headline">#</a></h2>
<p>XML ist ein anderes sehr weit verbreitetes Dateiformat. Alle Webseiten im Internet nutzen z.B. dieses Format. Es ist älter als JSON und immer noch sehr beliebt, weil es erlaubt Schemata (XLS) zu definieren, gegen diese die Datei validiert werden kann. So kann man z.B. sicher stellen das HTML-Dateien korrekt sind.</p>
<p>Mit Hilfe der externen Pakete <code class="docutils literal notranslate"><span class="pre">dicttoxml</span></code> und <code class="docutils literal notranslate"><span class="pre">xmltodict</span></code> können XML-Dateien auch einfach geschrieben und gelesen werden. Wir installieren sie mit <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">dicttoxml</span> <span class="n">xmltodict</span>  <span class="o">--</span><span class="n">quiet</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip available: <span class=" -Color -Color-Red">22.3</span> -&gt; <span class=" -Color -Color-Green">22.3.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;person.xml&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">dateinhalt</span> <span class="o">=</span> <span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dateinhalt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;person&gt;&lt;firstName type=&quot;str&quot;&gt;John&lt;/firstName&gt;&lt;lastName type=&quot;str&quot;&gt;Smith&lt;/lastName&gt;&lt;isAlive type=&quot;bool&quot;&gt;true&lt;/isAlive&gt;&lt;age type=&quot;int&quot;&gt;25&lt;/age&gt;&lt;address type=&quot;dict&quot;&gt;&lt;streetAddress type=&quot;str&quot;&gt;21 2nd Street&lt;/streetAddress&gt;&lt;city type=&quot;str&quot;&gt;New York&lt;/city&gt;&lt;state type=&quot;str&quot;&gt;NY&lt;/state&gt;&lt;postalCode type=&quot;str&quot;&gt;10021-3100&lt;/postalCode&gt;&lt;/address&gt;&lt;children type=&quot;list&quot;&gt;&lt;/children&gt;&lt;spouse type=&quot;null&quot;&gt;&lt;/spouse&gt;&lt;/person&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xmltodict</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;person.xml&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">person_geladen</span> <span class="o">=</span> <span class="n">xmltodict</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">xml_attribs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Datentyp </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">person_geladen</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">person_geladen</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Datentyp &lt;class &#39;dict&#39;&gt;
{&#39;person&#39;: {&#39;address&#39;: {&#39;city&#39;: &#39;New York&#39;,
                        &#39;postalCode&#39;: &#39;10021-3100&#39;,
                        &#39;state&#39;: &#39;NY&#39;,
                        &#39;streetAddress&#39;: &#39;21 2nd Street&#39;},
            &#39;age&#39;: &#39;25&#39;,
            &#39;children&#39;: None,
            &#39;firstName&#39;: &#39;John&#39;,
            &#39;isAlive&#39;: &#39;true&#39;,
            &#39;lastName&#39;: &#39;Smith&#39;,
            &#39;spouse&#39;: None}}
</pre></div>
</div>
</div>
</div>
<p>Auch hier entspricht das geladene <code class="docutils literal notranslate"><span class="pre">dict</span></code> unserem ursprünglichem.</p>
<section id="csv-dateien">
<h3>CSV-Dateien<a class="headerlink" href="#csv-dateien" title="Permalink to this headline">#</a></h3>
<p>Tabellen und Messwerte werden häufig als CSV-Dateien ausgetauscht. Dies ist ein sehr einfaches Format bei dem in der ersten Zeile der Text-Datei die Spaltennamen stehen und dann in jeder Zeile steht eine Reihe der Tabelle. Alle Werte werden durch Kommata <code class="docutils literal notranslate"><span class="pre">,</span></code> getrennt. Da das Komma im Deutschen als Dezimaltrennzeichen genutzt wird, wird hier häufig ein <code class="docutils literal notranslate"><span class="pre">;</span></code> oder Tabulator <code class="docutils literal notranslate"><span class="pre">\t</span></code> genutzt.</p>
<p>Zum Verarbeiten von Tabellen nutzt man in Python meist die <code class="docutils literal notranslate"><span class="pre">pandas</span></code>-Bibliothek. Wollen wir zum Beispiel den Datensatz zweier Personen speichern, so wandeln wir diesen zuerst in eine <code class="docutils literal notranslate"><span class="pre">pandas</span></code>-Tabelle (DataFrame) um.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leute</span><span class="o">=</span><span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;FirstName&quot;</span><span class="p">:</span><span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;LastName&quot;</span><span class="p">:</span><span class="s2">&quot;Smith&quot;</span><span class="p">,</span> <span class="s2">&quot;IsAlive&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;Age&quot;</span><span class="p">:</span><span class="mi">25</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;FirstName&quot;</span><span class="p">:</span><span class="s2">&quot;Mary&quot;</span><span class="p">,</span> <span class="s2">&quot;LastName&quot;</span><span class="p">:</span><span class="s2">&quot;Sue&quot;</span><span class="p">,</span> <span class="s2">&quot;IsAlive&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;Age&quot;</span><span class="p">:</span><span class="mi">30</span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">tabelle</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">leute</span><span class="p">)</span>
<span class="n">tabelle</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FirstName</th>
      <th>LastName</th>
      <th>IsAlive</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John</td>
      <td>Smith</td>
      <td>True</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mary</td>
      <td>Sue</td>
      <td>True</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Diesen können wir jetzt als CSV-Datei speichern.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabelle</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;leute.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># index=False sorgt dafür dass die Zeilennummern 0 und 1 weggelassen werden</span>
</pre></div>
</div>
</div>
</div>
<p>Wir lesen probeweise die Datei wieder ein. Da sie text-basiert ist können wir <code class="docutils literal notranslate"><span class="pre">open()</span></code> mit <code class="docutils literal notranslate"><span class="pre">tr</span></code> nutzen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;leute.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">dateinhalt</span> <span class="o">=</span> <span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dateinhalt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FirstName,LastName,IsAlive,Age
John,Smith,True,25
Mary,Sue,True,30
</pre></div>
</div>
</div>
</div>
<p>Wir können jetzt die CSV-Datei wieder in eine Tabelle laden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabelle_gelesen</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;leute.csv&quot;</span><span class="p">)</span>
<span class="n">tabelle_gelesen</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FirstName</th>
      <th>LastName</th>
      <th>IsAlive</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John</td>
      <td>Smith</td>
      <td>True</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mary</td>
      <td>Sue</td>
      <td>True</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>und zu dem Dictionary zurückverwandeln</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabelle_gelesen</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;FirstName&#39;: &#39;John&#39;, &#39;LastName&#39;: &#39;Smith&#39;, &#39;IsAlive&#39;: True, &#39;Age&#39;: 25},
 {&#39;FirstName&#39;: &#39;Mary&#39;, &#39;LastName&#39;: &#39;Sue&#39;, &#39;IsAlive&#39;: True, &#39;Age&#39;: 30}]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="typische-binare-dateiformate">
<h2>Typische binäre Dateiformate<a class="headerlink" href="#typische-binare-dateiformate" title="Permalink to this headline">#</a></h2>
<section id="xls-dateien">
<h3>XLS-Dateien<a class="headerlink" href="#xls-dateien" title="Permalink to this headline">#</a></h3>
<p>Diese CSV-Dateien können wir auch einfach in andere Programme wie Microsoft Excel einlesen oder von dort aus speichern. Das Hausformat von Excel sind <code class="docutils literal notranslate"><span class="pre">.xlsx</span></code> Dateien. Diese können wir mit dem Paket <code class="docutils literal notranslate"><span class="pre">openpyxl</span></code> auch direkt aus pandas heraus schreiben. Wir installieren uns <code class="docutils literal notranslate"><span class="pre">openpyxl</span></code> mit ´pip`.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">openpyxl</span>  <span class="o">--</span><span class="n">quiet</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip available: <span class=" -Color -Color-Red">22.3</span> -&gt; <span class=" -Color -Color-Green">22.3.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<p>Nach der installation können wir einfach die Tabelle als Excel-Datei exportieren.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabelle</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;leute.xlsx&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># index=False sorgt dafür dass die Zeilennummer weggelassen wird</span>
</pre></div>
</div>
</div>
</div>
<p>Diese Datei ist erstmal eine binäre Datei. Wir können sie also nicht mit <code class="docutils literal notranslate"><span class="pre">open()</span></code> und <code class="docutils literal notranslate"><span class="pre">tr</span></code> lesen, sondern müssen die binäre Variante mit <code class="docutils literal notranslate"><span class="pre">br</span></code> nehmen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;leute.xlsx&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">dateinhalt</span> <span class="o">=</span> <span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dateinhalt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b&#39;PK\x03\x04\x14\x00\x00\x00\x08\x00\xe8^\x90U\x07AMb\x81\x00\x00\x00\xb1\x00\x00\x00\x10\x00\x00\x00docProps/app.xmlM\x8e=\x0b\x021\x10D\xff\xcaq\xbd\xb7A\xc1Bb@\xd0R\xb0\xb2\x0f{\x1b/\x90dC\xb2B~\xbe9\xc1\x8fn\x1eo\x18F\xdf\ng*\xe2\xa9\x0e-\x86T\x8f\xe3&quot;\x92\x0f\x00\x15\x17\x8a\xb6N]\xa7n\x1c\x97h\xa5cy\x00;\xe7\x91\xce\x8c\xcfHI`\xab\xd4\x1e\xa8\t\xa5\x99\xe6M\xfe\x0e\x8eF\x9fr\x0e\x1e\xadxN\xe6\xea\xb1pe\&#39;\xc3\xa5!\x05\r\xffrm\xde\xa9\xd45\xef&amp;\xf5\x96\x1f\xd6\xf0;i^PK\x03\x04\x14\x00\x00\x00\x08\x00\xe8^\x90U\xa4\xbfh_\xee\x00\x00\x00+\x02\x00\x00\x11\x00\x00\x00docProps/core.xml\xcd\x92\xcfJ\x031\x10\x87_Er\xdf\x9d\xcd\x96V\x08\xdb\\\x14O\n\x82\x05\xc5[H\xa6mp\xf3\x87dd\xb7oovm\xb7\x88&gt;\x80\x90Kf~\xf9\xe6\x1bH\xa7\xa3\xd0!\xe1s\n\x11\x13Y\xcc7\xa3\xeb}\x16:n\xd9\x91(\n\x80\xac\x8f\xe8T\xaeK\xc2\x97\xe6&gt;$\xa7\xa8\\\xd3\x01\xa2\xd2\x1f\xea\x80\xd06\xcd\x06\x1c\x922\x8a\x14L\xc0*.D&amp;;\xa3\x85N\xa8(\xa43\xde\xe8\x05\x1f?S?\xc3\x8c\x06\xec\xd1\xa1\xa7\x0c\xbc\xe6\xc0\xe441\x9e\xc6\xbe\x83+`\x82\x11&amp;\x97\xbf\x0bh\x16\xe2\\\xfd\x13;w\x80\x9d\x93c\xb6Kj\x18\x86zX\xcd\xb9\xb2\x03\x87\xb7\xa7\xc7\x97y\xdd\xca\xfaL\xcak,\xaf\xb2\x15t\x8a\xb8e\x97\xc9\xaf\xab\xbb\xfb\xdd\x03\x93m\xd3\xb6\x15/g\xb3\xe3\\\xac\xd7\x82\xdf\xbeO\xae?\xfc\xae\xc2.\x18\xbb\xb7\xff\xd8\xf8&quot;(;\xf8\xf5/\xe4\x17PK\x03\x04\x14\x00\x00\x00\x08\x00\xe8^\x90U\x99\\\x9c#\x10\x06\x00\x00\x9c\&#39;\x00\x00\x13\x00\x00\x00xl/theme/theme1.xml\xedZ[s\xda8\x14~\xef\xaf\xd0xg\xf6m\x0b\xc66\x81\xb6\xb4\x13siv\xdb\xb4\x99\x84\xedN\x1f\x85\x11X\x8dlyd\x91\x84\x7f\xbfG6\x10\xcb\x96\r\xed\x92M\xba\x9b&lt;\x04,\xe9\xfb\xceEG\xe7\xe88y\xf3\xee.b\xe8\x86\x88\x94\xf2x`\xd9/\xdb\xd6\xbb\xb7/\xde\xe0W2$\x11A0\x19\xa7\xaf\xf0\xc0\n\xa5L^\xb5Zi\x00\xc38}\xc9\x13\x12\xc3\xdc\x82\x8b\x08Kx\x14\xcb\xd6\\\xe0[\x1a/#\xd6\xea\xb4\xdb\xddV\x84il\xa1\x18Gd`}^,h@\xd0TQZo_ \xb4\xe5\x1f3\xf8\x15\xcbT\x8de\xa3\x01\x13WA&amp;\xb9\x88\xb4\xf2\xf9l\xc5\xfc\xda\xde&gt;e\xcf\xe9:\x1d2\x81n0\x1bX \x7f\xceo\xa7\xe4NZ\x88\xe1T\xc2\xc4\xc0jg?Vk\xc7\xd1\xd2H\x80\x82\xc9}\x94\x05\xbaI\xf6\xa3\xd3\x15\x082\r;:\x9dX\xcev|\xf6\xc4\xed\x9f\x8c\xca\xdat4m\x1a\xe0\xe3\xf1x8\xb6\xcb\xd2\x8bp\x1c\x04\xe0Q\xbb\x9e\xc2\x9d\xf4l\xbf\xa4A\t\xb4\xa3i\xd0d\xd8\xf6\xda\xae\x91\xa6\xaa\x8dSO\xd3\xf7}\xdf\xeb\x9bh\x9c\n\x8d[O\xd3kw\xdd\xd3\x8e\x89\xc6\xad\xd0x\r\xbe\xf1O\x87\xc3\xae\x89\xc6\xab\xd0t\xebi&amp;\&#39;\xfd\xaek\xa4\xe9\x16hBF\xe3\xebz\x12\x15\xb5\xe5@\xd3 \x00Xpv\xd6\xcc\xd2\x03\x96^)\xfau\x94\x1a\xd9\x1d\xbb\xddA\\\xf0X\xee9\x89\x11\xfe\xc6\xc5\x04\xd6i\xd2\x19\x964Fr\x9d\x90\x05\x0e\x007\xc4\xd1LP|\xafA\xb6\x8a\xe0\xc2\x92\xd2\\\x90\xd6\xcf)\xb5P\x1a\x08\x9a\xc8\x81\xf5G\x82!\xc5\xdc\xaf\xfd\xf5\x97\xbb\xc9\xa43z\x9d}:\xcek\x94\x7fi\xab\x01\xa7\xed\xbb\x9b\xcf\x93\xfcs\xe8\xe4\x9f\xa7\x93\xd7MB\xcep\xbc,\t\xf1\xfb#[a\x87\&#39;n;\x13r:\x1cgB|\xcf\xf6\xf6\x91\xa5%2\xcf\xef\xf9\n\xebN&lt;g\x1fV\x96\xb0]\xcf\xcf\xe4\x9e\x8cr#\xbb\xdd\xf6X}\xf6OGn#\xd7\xa9\xc0\xb3&quot;\xd7\x94F$E\x9f\xc8-\xba\xe4\x118\xb5I\r2\x13?\x08\x9d\x86\x98jP\x1c\x02\xa4\t1\x96\xa1\x86\xf8\xb4\xc6\xac\x11\xe0\x13}\xb7\xbe\x08\xc8\xdf\x8d\x88\xf7\xabo\x9a=W\xa1XI\xda\x84\xf8\x10F\x1a\xe2\x9cs\xe6s\xd1l\xfb\x07\xa5F\xd1\xf6U\xbc\xdc\xa3\x97X\x15\x01\x97\x18\xdf4\xaa5,\xc5\xd6x\x95\xc0\xf1\xad\x9c&lt;\x1d\x13\x12\xcd\x94\x0b\x06A\x86\x97$&amp;\x12\xa99~MH\x13\xfe+\xa5\xda\xfe\x9c\xd3@\xf0\x94/$\xfaJ\x91\x8fi\xb3#\xa7t&amp;\xcd\xe83\x1a\xc1F\xaf\x1bu\x87h\xd2&lt;z\xfe\x05\xf9\x9c5\n\x1c\x91\x1b\x1d\x02g\x1b\xb3F!\x84i\xbb\xf0\x1e\xaf$\x8e\x9a\xad\xc2\x11+B&gt;b\x196\x1ar\xb5\x16\x81\xb6q\xa9\x84`Z\x12\xc6\xd1xN\xd2\xb4\x11\xfcY\xac5\x93&gt;`\xc8\xec\xcd\x91u\xce\xd6\x91\x0e\x11\x92^7B&gt;b\xce\x8b\x90\x11\xbf\x1e\x868J\x9a\xed\xa2qX\x04\xfd\x9e^\xc3I\xc1\xe8\x82\xcbf\xfd\xb8~\x86\xd53l,\x8e\xf7G\xd4\x17J\xe4\x0f&amp;\xa7?\xe924\x07\xa3\x9aY\t\xbd\x84Vj\x9f\xaa\x874&gt;\xa8\x1e2\n\x05\xf1\xb9\x1e&gt;\xe5zx\n7\x96\xc6\xbcP\xae\x82{\x01\xff\xd1\xda7\xc2\xab\xf8\x82\xc09\x7f.}\xcf\xa5\xef\xb9\xf4=\xa1\xd2\xb77#}g\xc1\xd3\x8b[\xdeFn[\xc4\xfb\xae1\xda\xd74.(cWr\xcd\xc8\xc7T\xaf\x93)\xd89\x9f\xc0\xec\xfdh&gt;\x9e\xf1\xed\xfa\xd9$\x84\xaf\x9aY-#\x16\x90K\x81\xb3A$\xb8\xfc\x8b\xca\xf0*\xc4\t\xe8d[%\t\xcbT\xd3e7\x8a\x12\x9eB\x1bn\xe9S\xf5J\x95\xd7\xe5\xaf\xb9(\xb8&lt;[\xe4\xe9\xaf\xa1t&gt;,\xcf\xf9&lt;_\xe7\xb4\xcd\x0b3C\xb7rK\xea\xb6\x94\xbe\xb5&amp;8J\xf4\xb1\xccpN\x1e\xcb\x0c;g&lt;\x92\x1d\xb6w\xa0\x1d5\xfb\xf6]v\xe4#\xa50S\x97C\xb8\x1aB\xbe\x03m\xba\x9d\xdc:8\x9e\x98\x91\xb9\n\xd3R\x90o\xc3\xf9\xe9\xc5x\x1a\xe29\xd9\x04\xb9}\x98Wm\xe7\xd8\xd1\xd1\xfb\xe7\xc1Q\xb0\xa3\xef&lt;\x96\x1d\xc7\x88\xf2\xa2!\xee\xa1\x86\x98\xcf\xc3C\x87y{_\x98g\x95\xc6P4\x14ml\xac$,F\xb7`\xb8\xd7\xf1,\x14\xe0d`-\xa0\x07\x83\xafQ\x02\xf2RU`1[\xc6\x03+\x90\xa2|L\x8cE\xe8p\xe7\x97\\_\xe3\xd1\x92\xe3\xdb\xa6e\xb5n\xaf)w\x19m&quot;R9\xc2i\x98\x13g\xab\xca\xdee\xb1\xc1U\x1d\xcfU[\xf2\xb0\xbej=\xb4\x15N\xcf\xfeY\xad\xc8\x9f\x0c\x11N\x16\x0b\x12Hc\x94\x17\xa6J\xa2\xf3\x19S\xbe\xe7+I\xc4U8\xbfE3\xb6\x12\x97\x18\xbc\xe3\xe6\xc7qNS\xb8\x12v\xb6\x0f\x022\xb9\xbb9\xa9ze1g\xa6\xf2\xdf-\x0c\t,[\x88Y\x12\xe2M]\xed\xd5\xe7\x9b\x9c\xaez&quot;v\xfa\x97w\xc1`\xf2\xfdp\xc9G\x0f\xe5;\xe7_\xf4]C\xae~\xf6\xdd\xe3\xfan\x93;HL\x9cy\xc5\x11\x01tE\x02#\x95\x1c\x06\x16\x172\xe4P\xee\x92\x90\x06\x13\x01\xcd\x94\xc9D\xf0\x02\x82d\xa6\x1c\x80\x98\xfa\x0b\xbd\xf2\x0c\xb9)\x15\xce\xad&gt;9\x7fE,\x83\x86N^\xd2%\x12\x14\x8a\xb0\x0c\x05!\x17r\xe3\xef\xef\x93jw\x8c\xd7\xfa,\x81m\x84T2d\xd5\x17\xcaC\x89\xc1=3rC\xd8T%\xf3\xae\xda&amp;\x0b\x85\xdb\xe2T\xcd\xbb\x1a\xbe&amp;`K\xc3zn\x9d-\&#39;\xff\xdb^\xd4=\xb4\x17=F\xf3\xa3\x99\xe0\x1e\xb3\x87s\x9bz\xb8\xc2E\xac\xffX\xd6\x1e\xf92\xdf9p\xdb:\xde\x03^\xe6\x13,C\xa4~\xc1}\x8a\x8a\x80\x11\xabb\xbe\xba\xafO\xf9%\x9c;\xb4{\xf1\x81 \x9b\xfc\xd6\xdb\xa4\xf6\xdd\xe0\x0c|\xd4\xabZ\xa5d+\x11?K\x07|\x1f\x92\x06c\x8c[\xf44_\x8f\x14b\xad\xa6\xb1\xad\xc6\xda1\x0cy\x80X\xf3\x0c\xa1f8\xdf\x87E\x9a\x1a3\xd5\x8b\xac9\x8d\noA\xd5@\xe5?\xdb\xd4\rh\xf6\r4\x1c\x91\x05^1\x99\xb66\xa3\xe4N\n&lt;\xdc\xfe\xef\r\xb0\xc2\xc4\x8e\xe1\xed\x8b\xbf\x01PK\x03\x04\x14\x00\x00\x00\x08\x00\xe8^\x90U.i\x91\xce\xa5\x01\x00\x00\x14\x04\x00\x00\x18\x00\x00\x00xl/worksheets/sheet1.xml}T\xdb\x8e\x9b0\x10\xfd\x15\xe4\x0fX\x93\xa0\xb4\xd5\n\x90\xb2\x89V\xdd\xaa\xad\xa2\x8d\xda&gt;;a\x00k}\xa1\xf6$\xb4\x7f\xdf\xb1\x93 \xba\x82&lt;1\xb73s\xce\xd8&amp;\xef\xad{\xf3-\x00&amp;\x7f\xb42\xbe`-b\xf7\xc8\xb9?\xb6\xa0\x85\x7f\xb0\x1d\x18\xca\xd4\xd6i\x81\xe4\xba\x86\xfb\xce\x81\xa8&quot;H+\xbeL\xd3\x0f\\\x0biX\x99\xc7\xd8\xce\x95\xb9=\xa1\x92\x06v.\xf1\&#39;\xad\x85\xfb\xfb\x04\xca\xf6\x05[\xb0[\xe0U6-\x86\x00/\xf3N4\xb0\x07\xfc\xd1\xed\x1cy|\xe8RI\r\xc6Kk\x12\x07u\xc1\xd6\x8b\xc7m\x16\xeac\xc1O\t\xbd\x1f\xd9IPr\xb0\xf6-8/U\xc1\xd2@\x08\x14\x1c1t\x10\xf49\xc3\x06\x94\n\x8d\x88\xc6\xefkO6\x8c\x0c\xc0\xb1}\xeb\xfe\x1c\xb5\x93\x96\x83\xf0\xb0\xb1\xea\x97\xac\xb0-\xd8\&#39;\x96TP\x8b\x93\xc2W\xdb\x7f\x86\xab\x9e\xd5@p+P\x94\xb9\xb3}\xe2\x82\xce2?\x06#\xce\x8e\x8b\xa0ji\xc2\x96\xf6\xe8(+i\x1c\x96\xcf\xd2y\xfc.4\xe4\x1c\x89K\x08\xf2\xe3\x15\xfat\x1f\xfaU\xcc&quot;7\xf7\x91/~\xadh9\x13\xc0\xed}\xe0\xbay\x07\xe2$w\xd0\xbc\x1c4/g\xf0_lk\xa6\x84\xce\xd5\xef\xb5\xc4vJ\xdf\x05p\xa0\xc2s\xb9\xc8\xf9y,\xe1\x9231\xb7\\\r\xc9\xff\xa8f\x03\xd5lf\xf47\xba\xb3ST\xe7\xea\xf7\xa7\xc9\x83\xc8\xee\x10\xcdFD\xb3\xf4\x1dQ&gt;\xbaS\xe1\xbd\x10\x9fF\x1a\x9f(\xa8\t\x94&gt;|\\\xb1\xc4]\xee\xe0\xc5A\xdb\xc5\x83;XD\xab\xa3\xd9\xd2\xb3\x05\x17\n(_[\x8b7\&#39;&lt;\x81\xe1GP\xfe\x03PK\x03\x04\x14\x00\x00\x00\x08\x00\xe8^\x90U\xe0\xeePG\xa9\x02\x00\x00\x16\x0b\x00\x00\r\x00\x00\x00xl/styles.xml\xddV\xdb\x8a\xdb0\x10\xfd\x15\xe1\x0f\xa8\x93\x98\x9a\xb8\xc4\x816\x10(\xb4ea\xf7\xa1\xafJ,\xc7\x02Yre9$\xfb\xf5\x9d\x91\x1c\xe7\xb2\x9a\xa5\xedc\x136\x1e\xcd\xd1\x993\x9a\x19\xe1]\xf5\xee\xac\xc4s#\x84c\xa7V\xe9\xbeL\x1a\xe7\xbaOi\xda\xef\x1b\xd1\xf2\xfe\x83\xe9\x84\x06\xa46\xb6\xe5\x0e\x96\xf6\x90\xf6\x9d\x15\xbc\xea\x91\xd4\xaat1\x9b\xe5i\xcb\xa5N\xd6+=\xb4\xdb\xd6\xf5lo\x06\xed\xcad\x96\xa4\xebUm\xf4\xd5\xb3H\x82\x03\xb6\xf2V\xb0#We\xb2\xe1J\xee\xac\xf4{y+\xd59\xb8\x17\xe8\xd8\x1be,s\x90\x8a(\x939z\xfa\xd7\x00\xcf\xc3\n\xb3\x1c\xe3\xb4R\x1b\x8b\xce4(\x84\xdf\xdd\xb8\xfd\x06\xf0\x8f\x1e6H\xa5\xee3\x03\xc7z\xd5q\xe7\x84\xd5[Xx\x8ew\xbe\x81\xd8h\xbf\x9c;H\xed`\xf9y\xbe\xf8\x98\\\t\xfe\x01&quot;;c+a\xefd\x82k\xbdR\xa2v@\xb0\xf2\xd0\xe0\xd3\x99.E\xd09\xd3\x82QI~0\x9a\xfb\x1c.\x8c[&amp;\xf3\xad+\x13\xd7@\xe9/a\x1e\x9d\x10\xf3\xd1\x15\x04\x1e\xbd\x93\xc4h@\xe6{\xa1\xd43\xee\xfaYO\xe9\xcf!\xfdS\xcdB\x9f\xbfV\xd8b\x86\xd5\xbc\x98p\xe6\xd1\x0ca\xc2\x02\xe3\xdfF\x0b\xb1o\xc2.\xfe),\xeb\xe4\xd1\xb8/\x03\x9cG\xfb\xf5\xaf\xc18\xf1dE-O~}\xaa\&#39;}*\xfa\x9c\x88\x0e~\xdeu\xea\xfcY\xc9\x83nE8\xfb\x1f\x0b\xaeW\xfc\xc2c\x8d\xb1\xf2\x15\xd4p\n\xf7\xe0\x106aGa\x9d\xdc\xa3\x07\x1a\xe4\xcbs\xaa\xc7\x1aM\xe5\xf1\xc5\xba+\xfc\xe4exy\xca\xe4\x07\xdeIuUe\xbbA*\&#39;\xf5\xb8jdU\t\xfd\xa6\xfe\x10\xde\xf1\x1d\\\xfa\xbb\xf8\xb0\xbf\x125\x1f\x94{\x99\xc02\xb9\xda\xdfE%\x87\xb6\x98v=a%\xc6]W\xfb\x1b\xce\xe0&lt;\x9fn.hI]\x89\x93\xa86\xe3\xd2\x1ev\xded`\x80\xea\xf8\xf1\xf3\xfb\x80l\xfd\&#39;\x8eP\x9c\x80\xc5\x11\xc4(\x1d*\x03\x8a\x13X\x94\xce\xfft\x9e%y\x9e\x80Q\xb9-\xa3\xc8\x92\xe4,IN`\xc5\x90\x8d\xffR:qN\x01\x9f\xf8I\x8b&quot;\xcb\xf2\x9c\xaa\xe8f\x13\xcd`C\xd5-\xcf\xf1/\x1e\x8d\xca\r\x19\x94\x0e*\xfd]\xad\xe9n\xd3\x13\xf2\xfe\x1cP=}oB\xa8\x93\xd2\x93H\x9d\x94\xae5&quot;\xf1\xba!\xa3(\xe2\xdd\xa6t\x90Au\x81\x9a\x1d\xd4\x8f\xeb\xe0L\xc59Y\x86]\xa5r\xa3n0\x8d\x14\x05\x85\xe0,\xc6g4\xcf\x89\xea\xe4\xf8\x8d\xf7\x87\xba%YV\x14q\x04\xb1x\x06YF!x\x1bi\x84\xca\x00s\xa0\x90,\xf3\xef\xc1\x87\xf7QzyO\xa5\xd7\xff\x84\xd7\xbf\x01PK\x03\x04\x14\x00\x00\x00\x08\x00\xe8^\x90U\x97\x8a\xbb\x1c\xc0\x00\x00\x00\x13\x02\x00\x00\x0b\x00\x00\x00_rels/.rels\x9d\x92\xb9n\xc30\x0c@\x7f\xc5\xd0\x9e0\x07\xd0!\x883e\xf1\x16\x04\xf9\x01V\xa2\x0f\xd8\x12\x05\x8aE\x9d\xbf\xaf\xda\xa5q\x90\x0b\x19y=&lt;\x12\xdc\x1ei@\xed8\xa4\xb6\x8b\xa9\x18\xfd\x10RiZ\xd5\xb8\x01H\xb6%\x8fi\xce\x91B\xae\xd4,\x1e5\x87\xd2@D\xdbcC\xb0Z,&gt;@.\x19f\xb7\xbdd\x16\xa7s\xa4W\x88\\\xd7\x9d\xa5=\xdb/OAo\x80\xaf:LqBiHK3\x0e\xf0\xcd\xd2\x7f2\xf7\xf3\x0c5E\xe5J#\x95[\x1ax\xd3\xe5\xfev\xe0I\xd1\xa1&quot;X\x16\x9aE\xc9\xd3\xa2\x1d\xa5\x7f\x1d\xc7\xf6\x90\xd3\xe9\xafc&quot;\xb4z[\xe8\xf9qhT\n\x8e\xdcc%\x8cqb\xb4\xfe5\x82\xc9\x0f\xec~\x00PK\x03\x04\x14\x00\x00\x00\x08\x00\xe8^\x90U\x1a\xba\x1b\xab0\x01\x00\x00#\x02\x00\x00\x0f\x00\x00\x00xl/workbook.xml\x8dQ\xd1J\xc3@\x10\xfc\x95p\x1f`R\xd1\x82\xa5\xe9\x8bE-\x88\x16+}\xbf$\x9bf\xe9\xddm\xd8\xdb\xb4\xda\xafw\x93\x10,\xf8\xe2\xd3\xde\xce,\xc3\xcc\xdc\xf2L|,\x88\x8e\xc9\x97w!\xe6\xa6\x11i\x17i\x1a\xcb\x06\xbc\x8d7\xd4BP\xa6&amp;\xf6Vt\xe5C\x1a[\x06[\xc5\x06@\xbcKo\xb3l\x9ez\x8b\xc1\xac\x96\x93\xd6\x96\xd3\xeb\x85\x04JA\n\n\xf6\xc0\x1e\xe1\x1c\x7f\xf9~MN\x18\xb1@\x87\xf2\x9d\x9b\xe1\xed\xc0$\x1e\x03z\xbc@\x95\x9b\xcc$\xb1\xa1\xf3\x0b1^(\x88u\xbb\x92\xc9\xb9\xdc\xccFb\x0f,X\xfe\x81w\xbd\xc9O[\xc4\x01\x11[|X5\x92\x9by\xa6\x825r\x94\xe1b\xd0\xb7\xea\xf1\x04z&lt;n\x9d\xd0\x13:\x01^[\x81g\xa6\xae\xc5p\xe8e4Ez\x15c\xe8a\x9ac\x89\x0b\xfeO\x8dT\xd7X\xc2\x9a\xca\xceC\x90\xb1G\x06\xd7\x1b\x0c\xb1\xc16\x9a$X\x0f\xb9\x19,\x0e\x81tn\xaa1\x9c\xa8\xab\xab\xaax\x81J\xf0\xa6\x1a\xfdM\xa6*\xa81@\xf5\xa6:Qq-\xa8\xdcr\xd2\x8fA\xe7\xf6\xee~\xf6\xa0Et\xce=*\xf6\x1e^\xc9VS\xc6\xe9\x7fV?PK\x03\x04\x14\x00\x00\x00\x08\x00\xe8^\x90U$\x1e\x9b\xa2\xad\x00\x00\x00\xf8\x01\x00\x00\x1a\x00\x00\x00xl/_rels/workbook.xml.rels\xb5\x91=\x0e\x830\x0c\x85\xaf\x12\xe5\x005P\xa9C\x05L]X+.\x10\x05\xf3#\x12\x12\xc5\xae\n\xb7/\x85\x01\x90:ta\xb2\x9e-\x7f\xef\xc9N\x9fh\x14wn\xa0\xb6\xf3$Fk\x06\xcad\xcb\xec\xef\x00\xa4[\xb4\x8a.\xce\xe30Oj\x17\xac\xe2Y\x86\x06\xbc\xd2\xbdj\x10\x92(\xbaA\xd83d\x9e\xee\x99\xa2\x9c&lt;\xfeCtu\xddi|8\xfd\xb28\xf0\x0f0\xbc]\xe8\xa9Ed)J\x15\x1a\xe4L\xc2h\xb66\xc1R\xe2\xcbL\x96\xa2\xa82\x19\x8a*\x96pZ \xe2\xc9 miV}\xb0ON\xb4\xe7y\x177\xf7E\xae\xcd\xe3\t\xae\xdf\x0cpxt\xfe\x01PK\x03\x04\x14\x00\x00\x00\x08\x00\xe8^\x90Ue\x90y\x92\x19\x01\x00\x00\xcf\x03\x00\x00\x13\x00\x00\x00[Content_Types].xml\xad\x93MN\xc30\x10\x85\xaf\x12e[%.,X\xa0\xa6\x1b`\x0b]p\x01cO\x1a\xab\xfe\x93gZ\xd2\xdb3N\xdaJ\xa0\x12\x15\x85M\xacx\xde\xbc\xcf\x9e\x97\xac\xde\x8f\x11\xb0\xe8\x9d\xf5\xd8\x94\x1dQ|\x14\x02U\x07Nb\x1d&quot;x\xae\xb4!9I\xfc\x9a\xb6&quot;J\xb5\x93[\x10\xf7\xcb\xe5\x83P\xc1\x13x\xaa({\x94\xeb\xd53\xb4ro\xa9x\xe9y\x1bM\xf0M\x99\xc0bY&lt;\x8d\xc2\xccjJ\x19\xa35J\x12\xd7\xc5\xc1\xeb\x1f\x94\xeaD\xa8\xb9s\xd0`g&quot;.XP\x8a\xab\x84\\\xf9\x1dp\xea{;@JFC\xb1\x91\x89^\xa5c\x95\xe8\xad@:Z\xc0z\xda\xe2\xca\x19C\xdb\x1a\x05:\xa8\xbd\xe3\x96\x1ac\x02\xa9\xb1\x03 g\xeb\xd1t1M&amp;\x9e0\x8c\xcf\xbb\xd9\xfc\xc1f\n\xc8\xcaM\n\x119\xb1\x04\x7f\xc7\x9d#\xc9\xddUd#Hd\xa6\xafx!\xb2\xf5\xec\xfbAN[\x83\xbe\x91\xcd\xe3\xfd\x0ci7\xe4\x81bX\xe6\xcf\xf8{\xc6\x17\xff\x1b\xce\xf1\x11\xc2\xee\xbf?\xb1\xbc\xd6N\x1a\x7f\xe6\x8b\xe1?^\x7f\x01PK\x01\x02\x14\x03\x14\x00\x00\x00\x08\x00\xe8^\x90U\x07AMb\x81\x00\x00\x00\xb1\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x01\x00\x00\x00\x00docProps/app.xmlPK\x01\x02\x14\x03\x14\x00\x00\x00\x08\x00\xe8^\x90U\xa4\xbfh_\xee\x00\x00\x00+\x02\x00\x00\x11\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x01\xaf\x00\x00\x00docProps/core.xmlPK\x01\x02\x14\x03\x14\x00\x00\x00\x08\x00\xe8^\x90U\x99\\\x9c#\x10\x06\x00\x00\x9c\&#39;\x00\x00\x13\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x01\xcc\x01\x00\x00xl/theme/theme1.xmlPK\x01\x02\x14\x03\x14\x00\x00\x00\x08\x00\xe8^\x90U.i\x91\xce\xa5\x01\x00\x00\x14\x04\x00\x00\x18\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x81\r\x08\x00\x00xl/worksheets/sheet1.xmlPK\x01\x02\x14\x03\x14\x00\x00\x00\x08\x00\xe8^\x90U\xe0\xeePG\xa9\x02\x00\x00\x16\x0b\x00\x00\r\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x01\xe8\t\x00\x00xl/styles.xmlPK\x01\x02\x14\x03\x14\x00\x00\x00\x08\x00\xe8^\x90U\x97\x8a\xbb\x1c\xc0\x00\x00\x00\x13\x02\x00\x00\x0b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x01\xbc\x0c\x00\x00_rels/.relsPK\x01\x02\x14\x03\x14\x00\x00\x00\x08\x00\xe8^\x90U\x1a\xba\x1b\xab0\x01\x00\x00#\x02\x00\x00\x0f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x01\xa5\r\x00\x00xl/workbook.xmlPK\x01\x02\x14\x03\x14\x00\x00\x00\x08\x00\xe8^\x90U$\x1e\x9b\xa2\xad\x00\x00\x00\xf8\x01\x00\x00\x1a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x01\x02\x0f\x00\x00xl/_rels/workbook.xml.relsPK\x01\x02\x14\x03\x14\x00\x00\x00\x08\x00\xe8^\x90Ue\x90y\x92\x19\x01\x00\x00\xcf\x03\x00\x00\x13\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x01\xe7\x0f\x00\x00[Content_Types].xmlPK\x05\x06\x00\x00\x00\x00\t\x00\t\x00&gt;\x02\x00\x001\x11\x00\x00\x00\x00&#39;
</pre></div>
</div>
</div>
</div>
<p>Was wir sehen sind viele unverständliche binäre Zeichen. Dahinter steckt in diesem Fall eine komprimierte ZIP-Datei, da das <code class="docutils literal notranslate"><span class="pre">.xlsx</span></code>-Dateiformat eigentlich nur eine ZIP-Datei ist die mehrere XML-Dateien enthält.</p>
</section>
<section id="zip-dateien">
<h3>ZIP-Dateien<a class="headerlink" href="#zip-dateien" title="Permalink to this headline">#</a></h3>
<p>ZIP-Dateien sind Dateien, welche andere Dateien und Verzeichnisse enthalten und diese komprimieren. Dadurch können mehrere Dateien in einer einzigen zusammengefasst werden und verbrauchen weniger Speicher. Deshalb werden ZIP-Dateien gerne im Versand mehrere Dateien verwendet.</p>
<p>Auch die <code class="docutils literal notranslate"><span class="pre">.xlsx</span></code> Datei von Excel ist eine verkappte ZIP-Datei, die mehrere XML-Dateien in dem offenen Office-Format enthält.</p>
<p>Dies lässt sich zeigen in dem wir die Datei in eine ZIP-Datei umbenennen mit <code class="docutils literal notranslate"><span class="pre">os.rename()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;leute.xlsx&quot;</span><span class="p">,</span> <span class="s2">&quot;leute.zip&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Wollen wir die Dateien in der Zip-Datei sehen, so können wir diese mit dem <code class="docutils literal notranslate"><span class="pre">ZipFile</span></code>-Objekt des Standardpaktes <code class="docutils literal notranslate"><span class="pre">zipfile</span></code> öffnen. Es funktioniert genauso wie <code class="docutils literal notranslate"><span class="pre">open()</span></code> nur für ZIP-Dateien. Mit der Methode <code class="docutils literal notranslate"><span class="pre">namelist</span></code> können wir alle Dateien in der Zip-Datei auflisten.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">zipfile</span>

<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="s2">&quot;leute.zip&quot;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zipdatei</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">zipdatei</span><span class="o">.</span><span class="n">namelist</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>docProps/app.xml
docProps/core.xml
xl/theme/theme1.xml
xl/worksheets/sheet1.xml
xl/styles.xml
_rels/.rels
xl/workbook.xml
xl/_rels/workbook.xml.rels
[Content_Types].xml
</pre></div>
</div>
</div>
</div>
<p>Um aus der Zip-Datei eine einzelne Datei zu lesen, können wir die <code class="docutils literal notranslate"><span class="pre">read()</span></code>-Methode nutzen. Laden wir z.B. die ‘xl/worksheets/sheet1.xml’ welche unsere Daten enthält so sehen wir unsere Daten in der typischen XML-Struktur.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="s2">&quot;leute.zip&quot;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zipdatei</span><span class="p">:</span>
    <span class="n">xmldatei</span> <span class="o">=</span> <span class="n">zipdatei</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;xl/worksheets/sheet1.xml&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">xmldatei</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b&#39;&lt;worksheet xmlns=&quot;http://schemas.openxmlformats.org/spreadsheetml/2006/main&quot;&gt;&lt;sheetPr&gt;&lt;outlinePr summaryBelow=&quot;1&quot; summaryRight=&quot;1&quot;/&gt;&lt;pageSetUpPr/&gt;&lt;/sheetPr&gt;&lt;dimension ref=&quot;A1:D3&quot;/&gt;&lt;sheetViews&gt;&lt;sheetView workbookViewId=&quot;0&quot;&gt;&lt;selection activeCell=&quot;A1&quot; sqref=&quot;A1&quot;/&gt;&lt;/sheetView&gt;&lt;/sheetViews&gt;&lt;sheetFormatPr baseColWidth=&quot;8&quot; defaultRowHeight=&quot;15&quot;/&gt;&lt;sheetData&gt;&lt;row r=&quot;1&quot;&gt;&lt;c r=&quot;A1&quot; s=&quot;1&quot; t=&quot;inlineStr&quot;&gt;&lt;is&gt;&lt;t&gt;FirstName&lt;/t&gt;&lt;/is&gt;&lt;/c&gt;&lt;c r=&quot;B1&quot; s=&quot;1&quot; t=&quot;inlineStr&quot;&gt;&lt;is&gt;&lt;t&gt;LastName&lt;/t&gt;&lt;/is&gt;&lt;/c&gt;&lt;c r=&quot;C1&quot; s=&quot;1&quot; t=&quot;inlineStr&quot;&gt;&lt;is&gt;&lt;t&gt;IsAlive&lt;/t&gt;&lt;/is&gt;&lt;/c&gt;&lt;c r=&quot;D1&quot; s=&quot;1&quot; t=&quot;inlineStr&quot;&gt;&lt;is&gt;&lt;t&gt;Age&lt;/t&gt;&lt;/is&gt;&lt;/c&gt;&lt;/row&gt;&lt;row r=&quot;2&quot;&gt;&lt;c r=&quot;A2&quot; t=&quot;inlineStr&quot;&gt;&lt;is&gt;&lt;t&gt;John&lt;/t&gt;&lt;/is&gt;&lt;/c&gt;&lt;c r=&quot;B2&quot; t=&quot;inlineStr&quot;&gt;&lt;is&gt;&lt;t&gt;Smith&lt;/t&gt;&lt;/is&gt;&lt;/c&gt;&lt;c r=&quot;C2&quot; t=&quot;b&quot;&gt;&lt;v&gt;1&lt;/v&gt;&lt;/c&gt;&lt;c r=&quot;D2&quot; t=&quot;n&quot;&gt;&lt;v&gt;25&lt;/v&gt;&lt;/c&gt;&lt;/row&gt;&lt;row r=&quot;3&quot;&gt;&lt;c r=&quot;A3&quot; t=&quot;inlineStr&quot;&gt;&lt;is&gt;&lt;t&gt;Mary&lt;/t&gt;&lt;/is&gt;&lt;/c&gt;&lt;c r=&quot;B3&quot; t=&quot;inlineStr&quot;&gt;&lt;is&gt;&lt;t&gt;Sue&lt;/t&gt;&lt;/is&gt;&lt;/c&gt;&lt;c r=&quot;C3&quot; t=&quot;b&quot;&gt;&lt;v&gt;1&lt;/v&gt;&lt;/c&gt;&lt;c r=&quot;D3&quot; t=&quot;n&quot;&gt;&lt;v&gt;30&lt;/v&gt;&lt;/c&gt;&lt;/row&gt;&lt;/sheetData&gt;&lt;pageMargins left=&quot;0.75&quot; right=&quot;0.75&quot; top=&quot;1&quot; bottom=&quot;1&quot; header=&quot;0.5&quot; footer=&quot;0.5&quot;/&gt;&lt;/worksheet&gt;&#39;
</pre></div>
</div>
</div>
</div>
<p>Mit der <code class="docutils literal notranslate"><span class="pre">parse</span></code>-Funktion des <code class="docutils literal notranslate"><span class="pre">xmltodict</span></code>-Paketes können wir diese XML-Datei zum Beispiel in ein ´dict´ in Python umwandeln.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xmldict</span> <span class="o">=</span> <span class="n">xmltodict</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">xmldatei</span><span class="p">,</span> <span class="n">xml_attribs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">xmldict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;worksheet&#39;: {&#39;dimension&#39;: None,
               &#39;pageMargins&#39;: None,
               &#39;sheetData&#39;: {&#39;row&#39;: [{&#39;c&#39;: [{&#39;is&#39;: {&#39;t&#39;: &#39;FirstName&#39;}},
                                            {&#39;is&#39;: {&#39;t&#39;: &#39;LastName&#39;}},
                                            {&#39;is&#39;: {&#39;t&#39;: &#39;IsAlive&#39;}},
                                            {&#39;is&#39;: {&#39;t&#39;: &#39;Age&#39;}}]},
                                     {&#39;c&#39;: [{&#39;is&#39;: {&#39;t&#39;: &#39;John&#39;}},
                                            {&#39;is&#39;: {&#39;t&#39;: &#39;Smith&#39;}},
                                            {&#39;v&#39;: &#39;1&#39;},
                                            {&#39;v&#39;: &#39;25&#39;}]},
                                     {&#39;c&#39;: [{&#39;is&#39;: {&#39;t&#39;: &#39;Mary&#39;}},
                                            {&#39;is&#39;: {&#39;t&#39;: &#39;Sue&#39;}},
                                            {&#39;v&#39;: &#39;1&#39;},
                                            {&#39;v&#39;: &#39;30&#39;}]}]},
               &#39;sheetFormatPr&#39;: None,
               &#39;sheetPr&#39;: {&#39;outlinePr&#39;: None, &#39;pageSetUpPr&#39;: None},
               &#39;sheetViews&#39;: {&#39;sheetView&#39;: {&#39;selection&#39;: None}}}}
</pre></div>
</div>
</div>
</div>
<p>Unser ursprüngliches Dictionary <code class="docutils literal notranslate"><span class="pre">leute</span></code>, welches wir oben definiert haben ist in diesem Dictionary nicht mehr erkenntlich. Das liegt daran, dass dieses Format von Microsoft Excel definiert wurde und nicht speziel für unseren Zweck ausgelegt ist. Wichtig ist allerdings, dass das Format durchaus durch Menschen lesbar ist, so dass heutzutage viele andere Tools, wie LibreOffice, Google Docs, etc. dieses Format lesen und schreiben können. Das ist ein wichtiger Grund für die Nutzung von offenen XML-Formaten.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Vorlesung"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="8_Module.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Pakete</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../Uebung/S1E1-Aufgabe-Print-Funktion/.lesson/instructions.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Aufgabe 1.1 - Der Print Befehl</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Joern Ploennigs, AI 4 Sustainable Construction, University of Rostock<br/>
  
      &copy; Copyright CC-BY-NC-SA 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>